<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Performance Improvement Plan</title>

  <!-- Import Materialize CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <style>
    body {
      background-color: #f5f5f5;
    }
    .container {
      margin-top: 30px;
      margin-bottom: 30px;
    }
    .card {
      padding: 20px;
      margin-bottom: 20px;
    }
    .section-title {
      color: #1976d2;
      margin-top: 20px;
      margin-bottom: 15px;
      border-bottom: 2px solid #1976d2;
      padding-bottom: 5px;
    }
    .performance-table {
      margin-top: 20px;
    }
    .signature-section {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 2px solid #e0e0e0;
    }
    .signature-box {
      border-bottom: 1px solid #000;
      min-height: 60px;
      margin-top: 10px;
    }
    .warning-box {
      background-color: #fff3e0;
      border-left: 4px solid #ff9800;
      padding: 15px;
      margin: 20px 0;
    }
    .print-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
    }
    .logo-header {
      text-align: center;
      margin-bottom: 20px;
    }
    .logo-header img {
      max-width: 250px;
      height: auto;
    }

    /* Hide display fields by default, show only in print */
    #empNameDisplay, #dateIssuedDisplay, #positionDisplay, 
    #pipDurationDisplay, #departmentDisplay, #supervisorDisplay,
    #pipReasonDisplay, #supportResourcesDisplay, #consequencesDisplay {
      display: none;
    }

    /* Print Styles for Legal Document */
    @media print {
      body {
        background-color: white;
        font-family: 'Times New Roman', Times, serif;
        font-size: 12pt;
        line-height: 1.6;
        color: #000;
      }
      .container {
        max-width: 100%;
        margin: 0;
        padding: 0;
      }
      .card {
        box-shadow: none;
        padding: 40px;
        background: white;
        page-break-inside: avoid;
      }
      .print-btn, .btn, button, .fixed-action-btn, .row:has(button) {
        display: none !important;
      }
      .section-title {
        color: #000;
        font-weight: bold;
        font-size: 14pt;
        margin-top: 20pt;
        margin-bottom: 10pt;
        border-bottom: 2px solid #000;
        page-break-after: avoid;
      }
      h4 {
        font-size: 18pt;
        font-weight: bold;
        text-align: center;
        margin-bottom: 20pt;
      }
      h5 {
        page-break-after: avoid;
      }
      table {
        border-collapse: collapse;
        width: 100%;
        margin: 15px 0;
        page-break-inside: auto;
      }
      table thead {
        background-color: #e0e0e0 !important;
        display: table-header-group;
      }
      table th, table td {
        border: 1px solid #000 !important;
        padding: 8pt;
        font-size: 11pt;
        text-align: left;
      }
      table th {
        font-weight: bold;
        background-color: #e0e0e0 !important;
      }
      table tr {
        page-break-inside: avoid;
      }
      .warning-box {
        background-color: #fff9e6 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        border: 2px solid #000;
        padding: 15px;
        margin: 20px 0;
        page-break-inside: avoid;
      }
      .signature-section {
        margin-top: 30pt;
        page-break-inside: avoid;
        display: flex;
        justify-content: space-between;
        gap: 20px;
      }
      .signature-section .col {
        flex: 1;
        float: none;
        width: auto;
      }
      .signature-box {
        border-bottom: 1px solid #000;
        min-height: 50pt;
        margin-top: 10px;
        margin-bottom: 5px;
      }
      input {
        border: none !important;
        box-shadow: none !important;
        font-family: 'Times New Roman', Times, serif;
        color: #000 !important;
        font-size: 12pt;
      }
      textarea {
        border: none !important;
        box-shadow: none !important;
        font-family: 'Times New Roman', Times, serif;
        color: #000 !important;
        font-size: 12pt;
        min-height: auto !important;
      }
      .input-field {
        margin: 0;
        padding: 0;
      }
      .input-field label {
        display: none;
      }
      .logo-header {
        text-align: center;
        margin-bottom: 30px;
      }
      .logo-header img {
        max-width: 200px;
      }
      .row {
        margin-bottom: 0;
      }
      p {
        margin: 10px 0;
      }
      
      /* Pagination */
      @page {
        margin: 0.75in;
        size: letter;
        @bottom-right {
          content: "Page " counter(page) " of " counter(pages);
          font-family: 'Times New Roman', Times, serif;
          font-size: 10pt;
        }
      }
      
      @page :first {
        @bottom-right {
          content: "Page " counter(page) " of " counter(pages);
        }
      }
      
      /* Page numbers in footer */
      .page-number {
        position: fixed;
        bottom: 0.5in;
        right: 0.75in;
        font-family: 'Times New Roman', Times, serif;
        font-size: 10pt;
        display: block;
      }
      
      /* Hide edit fields in print, show display fields */
      .edit-fields {
        display: none !important;
      }
      
      #empNameDisplay, #dateIssuedDisplay, #positionDisplay, 
      #pipDurationDisplay, #departmentDisplay, #supervisorDisplay,
      #pipReasonDisplay, #supportResourcesDisplay, #consequencesDisplay {
        display: block !important;
        border-bottom: none !important;
      }
      
      #empNameDisplay, #dateIssuedDisplay, #positionDisplay, 
      #pipDurationDisplay, #departmentDisplay, #supervisorDisplay {
        display: inline-block !important;
      }
    }

    /* Preview Modal Styles */
    #previewModal {
      max-width: 90%;
      height: 90%;
      overflow-y: auto;
    }
    #previewContent {
      padding: 40px;
      background: white;
      font-family: 'Times New Roman', Times, serif;
      font-size: 12pt;
      line-height: 1.6;
    }
    #previewContent h4 {
      text-align: center;
      font-size: 18pt;
      margin-bottom: 20px;
    }
    #previewContent .section-title {
      font-weight: bold;
      font-size: 14pt;
      margin-top: 20px;
      margin-bottom: 10px;
      border-bottom: 2px solid #000;
      color: #000;
    }
    #previewContent table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
    }
    #previewContent table th,
    #previewContent table td {
      border: 1px solid #000;
      padding: 8px;
      text-align: left;
    }
    #previewContent table th {
      background-color: #e0e0e0;
      font-weight: bold;
    }
    #previewContent .warning-box {
      border: 2px solid #000;
      padding: 15px;
      margin: 20px 0;
      background-color: #fff9e6;
    }
    #previewContent .signature-section {
      margin-top: 30px;
      display: flex;
      justify-content: space-between;
      gap: 20px;
    }
    #previewContent .signature-item {
      flex: 1;
    }
    #previewContent .signature-line {
      border-bottom: 1px solid #000;
      min-height: 50px;
      margin-top: 10px;
      margin-bottom: 5px;
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="card">
      <div class="logo-header">
        <img src="https://digitalmindsbpo.com/storage/2021/11/cropped-Digital_Minds_Logo_Original.png" alt="Digital Minds BPO Logo">
      </div>
      
      <h4 class="center-align">Performance Improvement Plan</h4>

      <!-- Employee Details Section -->
      <h5 class="section-title">Employee Details</h5>
      <div class="row">
        <div class="col s12 m6">
          <p><strong>Employee Name:</strong> <span id="empNameDisplay" style="display:inline-block; min-width:200px; border-bottom: 1px dotted #999;"></span></p>
        </div>
        <div class="col s12 m6">
          <p><strong>Date Issued:</strong> <span id="dateIssuedDisplay" style="display:inline-block; min-width:200px; border-bottom: 1px dotted #999;"></span></p>
        </div>
        <div class="col s12 m6">
          <p><strong>Position:</strong> <span id="positionDisplay" style="display:inline-block; min-width:200px; border-bottom: 1px dotted #999;"></span></p>
        </div>
        <div class="col s12 m6">
          <p><strong>PIP Duration:</strong> <span id="pipDurationDisplay" style="display:inline-block; min-width:200px; border-bottom: 1px dotted #999;"></span></p>
        </div>
        <div class="col s12 m6">
          <p><strong>Department:</strong> <span id="departmentDisplay" style="display:inline-block; min-width:200px; border-bottom: 1px dotted #999;"></span></p>
        </div>
        <div class="col s12 m6">
          <p><strong>Supervisor:</strong> <span id="supervisorDisplay" style="display:inline-block; min-width:200px; border-bottom: 1px dotted #999;"></span></p>
        </div>
      </div>
      
      <!-- Editable fields (hidden during print) -->
      <div class="edit-fields">
        <div class="row">
          <div class="input-field col s12 m6">
            <input id="employeeName" type="text" class="validate" required>
            <label for="employeeName">Employee Name</label>
          </div>
          <div class="input-field col s12 m6">
            <input id="dateIssued" type="date" class="validate" required>
            <label for="dateIssued">Date Issued</label>
          </div>
          <div class="input-field col s12 m6">
            <input id="position" type="text" class="validate" required>
            <label for="position">Position</label>
          </div>
          <div class="input-field col s12 m6">
            <input id="pipDuration" type="text" class="validate" required>
            <label for="pipDuration">PIP Duration</label>
          </div>
          <div class="input-field col s12 m6">
            <input id="department" type="text" class="validate" required>
            <label for="department">Department</label>
          </div>
          <div class="input-field col s12 m6">
            <input id="supervisor" type="text" class="validate" required>
            <label for="supervisor">Supervisor</label>
          </div>
        </div>
      </div>

      <!-- Reason for PIP -->
      <h5 class="section-title">Reason for PIP</h5>
      <div class="row">
        <div class="col s12">
          <p id="pipReasonDisplay" style="display:none; text-align: justify;"></p>
        </div>
        <div class="input-field col s12 edit-fields">
          <textarea id="pipReason" class="materialize-textarea" required></textarea>
          <label for="pipReason">Reason for Performance Improvement Plan</label>
        </div>
      </div>

      <!-- Performance Expectations -->
      <h5 class="section-title">Performance Expectations</h5>
      
      <!-- Monthly Performance Table -->
      <table class="highlight responsive-table performance-table">
        <thead>
          <tr>
            <th>Month</th>
            <th>Metric</th>
            <th>Current Performance</th>
            <th>Expected Performance</th>
          </tr>
        </thead>
        <tbody id="performanceTableBody">
          <!-- Dynamic rows will be added here -->
        </tbody>
      </table>

      <div class="row" style="margin-top: 20px;">
        <div class="col s12">
          <button class="btn waves-effect waves-light" onclick="addPerformanceRow()">
            <i class="material-icons left">add</i>Add Performance Row
          </button>
        </div>
      </div>

      <!-- Additional Performance Areas -->
      <h5 class="section-title">Additional Performance Areas</h5>
      <table class="highlight responsive-table">
        <thead>
          <tr>
            <th>Area of Concern</th>
            <th>Current Performance</th>
            <th>Expected Performance</th>
          </tr>
        </thead>
        <tbody id="additionalAreasBody">
          <!-- Dynamic rows will be added here -->
        </tbody>
      </table>

      <div class="row" style="margin-top: 20px;">
        <div class="col s12">
          <button class="btn waves-effect waves-light" onclick="addAdditionalAreaRow()">
            <i class="material-icons left">add</i>Add Additional Area
          </button>
        </div>
      </div>

      <!-- Support & Resources -->
      <h5 class="section-title">Support & Resources</h5>
      <div class="row">
        <div class="col s12">
          <p id="supportResourcesDisplay" style="display:none; text-align: justify;"></p>
        </div>
        <div class="input-field col s12 edit-fields">
          <textarea id="supportResources" class="materialize-textarea" required></textarea>
          <label for="supportResources">Support and Resources Provided</label>
        </div>
      </div>

      <!-- Consequences -->
      <div class="warning-box">
        <h6><strong>Consequences of Not Meeting Expectations</strong></h6>
        <div class="row">
          <div class="col s12">
            <p id="consequencesDisplay" style="display:none; text-align: justify;"></p>
          </div>
          <div class="input-field col s12 edit-fields">
            <textarea id="consequences" class="materialize-textarea" required></textarea>
            <label for="consequences">Consequences</label>
          </div>
        </div>
      </div>

      <!-- Acknowledgment & Signatures -->
      <h5 class="section-title">Acknowledgment</h5>
      <p>By signing this document, both parties acknowledge the terms and expectations outlined in this Performance Improvement Plan.</p>

      <div class="signature-section">
        <div class="row">
          <div class="col s12 m4">
            <strong>Employee Signature:</strong>
            <div class="signature-box"></div>
            <div class="input-field">
              <input id="employeeSigDate" type="date" class="validate">
              <label for="employeeSigDate">Date</label>
            </div>
          </div>
          <div class="col s12 m4">
            <strong>Supervisor Signature:</strong>
            <div class="signature-box"></div>
            <div class="input-field">
              <input id="supervisorSigDate" type="date" class="validate">
              <label for="supervisorSigDate">Date</label>
            </div>
          </div>
          <div class="col s12 m4">
            <strong>HR Representative:</strong>
            <div class="signature-box"></div>
            <div class="input-field">
              <input id="hrSigDate" type="date" class="validate">
              <label for="hrSigDate">Date</label>
            </div>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="row" style="margin-top: 30px;">
        <div class="col s12 center-align">
          <button class="btn waves-effect waves-light blue" onclick="previewPIP()">
            <i class="material-icons left">visibility</i>Preview
          </button>
          <button class="btn waves-effect waves-light green" onclick="savePDF()">
            <i class="material-icons left">save</i>Save as PDF
          </button>
          <button class="btn waves-effect waves-light teal" onclick="saveToGoogleSheets()">
            <i class="material-icons left">cloud_upload</i>Save to Google Sheets
          </button>
          <button class="btn waves-effect waves-light orange" onclick="window.print()">
            <i class="material-icons left">print</i>Print
          </button>
          <button class="btn waves-effect waves-light red" onclick="clearForm()">
            <i class="material-icons left">clear</i>Clear
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Preview Modal -->
  <div id="previewModal" class="modal">
    <div class="modal-content" id="previewContent">
      <!-- Preview content will be generated here -->
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
      <a href="#!" class="waves-effect waves-green btn blue" onclick="window.print()">Print This</a>
    </div>
  </div>

  <!-- Floating Action Button for Print -->
  <div class="fixed-action-btn print-btn">
    <a class="btn-floating btn-large orange" onclick="window.print()">
      <i class="large material-icons">print</i>
    </a>
  </div>

  <!-- Import Materialize JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

  <script>
    // Initialize Materialize
    M.AutoInit();

    let performanceRowCount = 0;
    let additionalAreaCount = 0;
    let modalInstance;

    // Update display fields when inputs change
    function updateDisplayFields() {
      document.getElementById('empNameDisplay').textContent = document.getElementById('employeeName').value || '___________________';
      document.getElementById('dateIssuedDisplay').textContent = formatDate(document.getElementById('dateIssued').value);
      document.getElementById('positionDisplay').textContent = document.getElementById('position').value || '___________________';
      document.getElementById('pipDurationDisplay').textContent = document.getElementById('pipDuration').value || '___________________';
      document.getElementById('departmentDisplay').textContent = document.getElementById('department').value || '___________________';
      document.getElementById('supervisorDisplay').textContent = document.getElementById('supervisor').value || '___________________';
      document.getElementById('pipReasonDisplay').textContent = document.getElementById('pipReason').value || '';
      document.getElementById('supportResourcesDisplay').textContent = document.getElementById('supportResources').value || '';
      document.getElementById('consequencesDisplay').textContent = document.getElementById('consequences').value || '';
    }

    // Add event listeners to update display fields
    document.addEventListener('DOMContentLoaded', function() {
      const fields = ['employeeName', 'dateIssued', 'position', 'pipDuration', 'department', 'supervisor', 'pipReason', 'supportResources', 'consequences'];
      fields.forEach(field => {
        const element = document.getElementById(field);
        if (element) {
          element.addEventListener('input', updateDisplayFields);
          element.addEventListener('change', updateDisplayFields);
        }
      });
    });

    // Initialize Modal
    document.addEventListener('DOMContentLoaded', function() {
      const elems = document.querySelectorAll('.modal');
      modalInstance = M.Modal.init(elems[0], {dismissible: true});
    });

    // Add Performance Row
    function addPerformanceRow() {
      performanceRowCount++;
      const tbody = document.getElementById('performanceTableBody');
      const row = document.createElement('tr');
      row.id = `perfRow${performanceRowCount}`;
      row.innerHTML = `
        <td><input type="text" placeholder="e.g., June" id="month${performanceRowCount}"></td>
        <td><input type="text" placeholder="e.g., Conversion Rate" id="metric${performanceRowCount}"></td>
        <td><input type="text" placeholder="e.g., 2.15%" id="current${performanceRowCount}"></td>
        <td><input type="text" placeholder="e.g., 8%" id="expected${performanceRowCount}"></td>
      `;
      tbody.appendChild(row);
      M.updateTextFields();
    }

    // Add Additional Area Row
    function addAdditionalAreaRow() {
      additionalAreaCount++;
      const tbody = document.getElementById('additionalAreasBody');
      const row = document.createElement('tr');
      row.id = `areaRow${additionalAreaCount}`;
      row.innerHTML = `
        <td><input type="text" placeholder="e.g., Attendance Score" id="areaName${additionalAreaCount}"></td>
        <td><input type="text" placeholder="e.g., 80%" id="areaCurrent${additionalAreaCount}"></td>
        <td><input type="text" placeholder="e.g., 95%" id="areaExpected${additionalAreaCount}"></td>
      `;
      tbody.appendChild(row);
      M.updateTextFields();
    }

    // Preview PIP - Shows formatted legal document
    function previewPIP() {
      const data = collectFormData();
      
      let performanceTable = '';
      if (data.performanceData.length > 0) {
        performanceTable = `
          <table>
            <thead>
              <tr>
                <th>Month</th>
                <th>Metric</th>
                <th>Current Performance</th>
                <th>Expected Performance</th>
              </tr>
            </thead>
            <tbody>
              ${data.performanceData.map(row => `
                <tr>
                  <td>${row.month}</td>
                  <td>${row.metric}</td>
                  <td>${row.current}</td>
                  <td>${row.expected}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        `;
      }

      let additionalAreasTable = '';
      if (data.additionalAreas.length > 0) {
        additionalAreasTable = `
          <h5 class="section-title">Additional Performance Areas</h5>
          <table>
            <thead>
              <tr>
                <th>Area of Concern</th>
                <th>Current Performance</th>
                <th>Expected Performance</th>
              </tr>
            </thead>
            <tbody>
              ${data.additionalAreas.map(row => `
                <tr>
                  <td>${row.area}</td>
                  <td>${row.current}</td>
                  <td>${row.expected}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        `;
      }

      const previewHTML = `
        <div style="text-align: center; margin-bottom: 30px;">
          <img src="https://digitalmindsbpo.com/storage/2021/11/cropped-Digital_Minds_Logo_Original.png" alt="Digital Minds BPO Logo" style="max-width: 200px;">
        </div>
        <h4>Performance Improvement Plan</h4>
        
        <h5 class="section-title">Employee Details</h5>
        <table>
          <tr><td><strong>Employee Name:</strong></td><td>${data.employeeName}</td></tr>
          <tr><td><strong>Date Issued:</strong></td><td>${formatDate(data.dateIssued)}</td></tr>
          <tr><td><strong>Position:</strong></td><td>${data.position}</td></tr>
          <tr><td><strong>PIP Duration:</strong></td><td>${data.pipDuration}</td></tr>
          <tr><td><strong>Department:</strong></td><td>${data.department}</td></tr>
          <tr><td><strong>Supervisor:</strong></td><td>${data.supervisor}</td></tr>
        </table>

        <h5 class="section-title">Reason for PIP</h5>
        <p>${data.pipReason}</p>

        <h5 class="section-title">Performance Expectations</h5>
        ${performanceTable}
        ${additionalAreasTable}

        <h5 class="section-title">Support & Resources</h5>
        <p>${data.supportResources}</p>

        <div class="warning-box">
          <h6><strong>Consequences of Not Meeting Expectations</strong></h6>
          <p>${data.consequences}</p>
        </div>

        <h5 class="section-title">Acknowledgment</h5>
        <p>By signing this document, both parties acknowledge the terms and expectations outlined in this Performance Improvement Plan.</p>

        <div class="signature-section">
          <div class="signature-item">
            <strong>Employee Signature:</strong>
            <div class="signature-line"></div>
            <p>Date: ${formatDate(data.signatures.employeeDate)}</p>
          </div>
          <div class="signature-item">
            <strong>Supervisor Signature:</strong>
            <div class="signature-line"></div>
            <p>Date: ${formatDate(data.signatures.supervisorDate)}</p>
          </div>
          <div class="signature-item">
            <strong>HR Representative:</strong>
            <div class="signature-line"></div>
            <p>Date: ${formatDate(data.signatures.hrDate)}</p>
          </div>
        </div>
      `;

      document.getElementById('previewContent').innerHTML = previewHTML;
      modalInstance.open();
    }

    // Save as PDF (browser's print to PDF functionality)
    function savePDF() {
      // Update display fields before printing
      updateDisplayFields();
      
      M.toast({html: 'Opening print dialog - select "Save as PDF" as destination', classes: 'blue', displayLength: 3000});
      
      setTimeout(() => {
        window.print();
      }, 1000);
    }

    // Save to Google Sheets
    function saveToGoogleSheets() {
      const data = collectFormData();
      
      // Create CSV format
      let csv = 'Performance Improvement Plan Data\n\n';
      csv += 'EMPLOYEE DETAILS\n';
      csv += `Employee Name,${data.employeeName}\n`;
      csv += `Date Issued,${data.dateIssued}\n`;
      csv += `Position,${data.position}\n`;
      csv += `PIP Duration,${data.pipDuration}\n`;
      csv += `Department,${data.department}\n`;
      csv += `Supervisor,${data.supervisor}\n\n`;
      
      csv += 'REASON FOR PIP\n';
      csv += `"${data.pipReason}"\n\n`;
      
      if (data.performanceData.length > 0) {
        csv += 'PERFORMANCE EXPECTATIONS\n';
        csv += 'Month,Metric,Current Performance,Expected Performance\n';
        data.performanceData.forEach(row => {
          csv += `${row.month},${row.metric},${row.current},${row.expected}\n`;
        });
        csv += '\n';
      }
      
      if (data.additionalAreas.length > 0) {
        csv += 'ADDITIONAL PERFORMANCE AREAS\n';
        csv += 'Area of Concern,Current Performance,Expected Performance\n';
        data.additionalAreas.forEach(row => {
          csv += `${row.area},${row.current},${row.expected}\n`;
        });
        csv += '\n';
      }
      
      csv += 'SUPPORT & RESOURCES\n';
      csv += `"${data.supportResources}"\n\n`;
      
      csv += 'CONSEQUENCES\n';
      csv += `"${data.consequences}"\n\n`;
      
      csv += 'SIGNATURES\n';
      csv += `Employee Date,${data.signatures.employeeDate}\n`;
      csv += `Supervisor Date,${data.signatures.supervisorDate}\n`;
      csv += `HR Date,${data.signatures.hrDate}\n`;

      // Download CSV file
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      link.setAttribute('href', url);
      link.setAttribute('download', `PIP_${data.employeeName.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.csv`);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      M.toast({html: 'CSV file downloaded! You can import this into Google Sheets (File > Import)', classes: 'green', displayLength: 6000});
      
      // Show instructions
      setTimeout(() => {
        alert('Instructions to import to Google Sheets:\n\n1. Open Google Sheets\n2. Click File > Import\n3. Select "Upload" tab\n4. Upload the CSV file that was just downloaded\n5. Choose import options and click "Import data"');
      }, 500);
    }

    // Collect Form Data
    function collectFormData() {
      const performanceData = [];
      for (let i = 1; i <= performanceRowCount; i++) {
        const month = document.getElementById(`month${i}`)?.value;
        if (month) {
          performanceData.push({
            month: month,
            metric: document.getElementById(`metric${i}`).value,
            current: document.getElementById(`current${i}`).value,
            expected: document.getElementById(`expected${i}`).value
          });
        }
      }

      const additionalAreas = [];
      for (let i = 1; i <= additionalAreaCount; i++) {
        const areaName = document.getElementById(`areaName${i}`)?.value;
        if (areaName) {
          additionalAreas.push({
            area: areaName,
            current: document.getElementById(`areaCurrent${i}`).value,
            expected: document.getElementById(`areaExpected${i}`).value
          });
        }
      }

      return {
        employeeName: document.getElementById('employeeName').value,
        dateIssued: document.getElementById('dateIssued').value,
        position: document.getElementById('position').value,
        pipDuration: document.getElementById('pipDuration').value,
        department: document.getElementById('department').value,
        supervisor: document.getElementById('supervisor').value,
        pipReason: document.getElementById('pipReason').value,
        performanceData: performanceData,
        additionalAreas: additionalAreas,
        supportResources: document.getElementById('supportResources').value,
        consequences: document.getElementById('consequences').value,
        signatures: {
          employeeDate: document.getElementById('employeeSigDate').value,
          supervisorDate: document.getElementById('supervisorSigDate').value,
          hrDate: document.getElementById('hrSigDate').value
        }
      };
    }

    // Format Date
    function formatDate(dateStr) {
      if (!dateStr) return '_________________';
      const date = new Date(dateStr);
      return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
    }

    // Clear Form
    function clearForm() {
      if (confirm('Are you sure you want to clear all form data?')) {
        document.querySelectorAll('input, textarea').forEach(el => el.value = '');
        document.getElementById('performanceTableBody').innerHTML = '';
        document.getElementById('additionalAreasBody').innerHTML = '';
        performanceRowCount = 0;
        additionalAreaCount = 0;
        M.updateTextFields();
        M.toast({html: 'Form cleared', classes: 'orange'});
      }
    }// Load Sample Data
function loadSampleData() {
  document.getElementById('employeeName').value = 'Employee A';
  document.getElementById('dateIssued').value = '2025-10-18';
  document.getElementById('position').value = 'Role Title';
  document.getElementById('pipDuration').value = '1 Month';
  document.getElementById('department').value = 'Department X';
  document.getElementById('supervisor').value = 'Supervisor B';
  document.getElementById('pipReason').value = 
    'Employee A did not meet the required standards for target conversion rate and daily/monthly transfer goals.';
  document.getElementById('supportResources').value = 
    'Coaching sessions with supervisor. Daily review of performance using available reports.';
  document.getElementById('consequences').value = 
    'Failure to meet the expectations outlined in this plan may result in further disciplinary action.';

  // Add sample performance data
  const samplePerformance = [
    {month: 'June', metric: 'Conversion Rate', current: '2.15%', expected: '8%'},
    {month: 'June', metric: 'Average Transfer', current: '1', expected: '10'},
    {month: 'July', metric: 'Conversion Rate', current: '3.98%', expected: '8%'},
    {month: 'July', metric: 'Average Transfer', current: '2', expected: '10'},
    {month: 'August', metric: 'Conversion Rate', current: '4.15%', expected: '8%'},
    {month: 'August', metric: 'Average Transfer', current: '3', expected: '10'},
  ];

  samplePerformance.forEach(data => {
    addPerformanceRow();
    document.getElementById(`month${performanceRowCount}`).value = data.month;
    document.getElementById(`metric${performanceRowCount}`).value = data.metric;
    document.getElementById(`current${performanceRowCount}`).value = data.current;
    document.getElementById(`expected${performanceRowCount}`).value = data.expected;
  });

  // Add sample additional areas
  const sampleAreas = [
    {area: 'Attendance Score (MTD)', current: '80%', expected: '95%'},
    {area: 'Adherence to House Rules', current: 'Needs Improvement', expected: 'Excellent'},
    {area: 'Adherence to Employment Standards', current: 'Needs Improvement', expected: 'Excellent'}
  ];
  
  sampleAreas.forEach(data => {
    addAdditionalAreaRow();
    document.getElementById(`areaName${additionalAreaCount}`).value = data.area;
    document.getElementById(`areaCurrent${additionalAreaCount}`).value = data.current;
    document.getElementById(`areaExpected${additionalAreaCount}`).value = data.expected;
  });
  
  M.updateTextFields();
  updateDisplayFields();
  M.toast({html: 'Sample data loaded successfully!', classes: 'blue'});
}


    // Initialize with sample data button
    window.onload = function() {
      const loadBtn = document.createElement('button');
      loadBtn.className = 'btn waves-effect waves-light grey darken-2';
      loadBtn.innerHTML = '<i class="material-icons left">file_download</i>Load Sample Data';
      loadBtn.onclick = loadSampleData;
      loadBtn.style.marginLeft = '10px';
      
      const actionRow = document.querySelector('.row:last-child .col');
      actionRow.appendChild(loadBtn);
    };
  </script>

</body>
</html>