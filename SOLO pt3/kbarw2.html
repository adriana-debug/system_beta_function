<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ARW Portal — Home Hub & Knowledge Base</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'media',
      theme: {
        extend: {
          colors: { brandAccent: '#3b82f6', brandDark: '#0f172a' },
          fontFamily: { sans: ['Inter','system-ui','-apple-system','Segoe UI','Roboto','sans-serif'] }
        }
      }
    }
  </script>

  <style>
    html,body { height:100%; margin:0; font-family:Inter, sans-serif; }
    body { display:flex; flex-direction:column; min-height:100vh; background:#f8fafc; color:#0f172a; }
    main { flex:1 0 auto; }
    footer { flex-shrink:0; }

    /* Sidebar drawer */
    .drawer { transition: transform .28s cubic-bezier(.4,0,.2,1); transform: translateX(-100%); }
    .drawer-open { transform: translateX(0); }
    .nav-item { transition: all .18s ease; border-radius:.6rem; color:inherit; display:flex; align-items:center; gap:.75rem; padding:.65rem; width:100%; text-align:left; }
    .nav-item:hover { transform:translateY(-3px); box-shadow:0 8px 24px rgba(59,130,246,.06); background: rgba(59,130,246,.06); color:#0f172a; }
    .nav-active { background:linear-gradient(90deg, rgba(59,130,246,.12), rgba(59,130,246,.06)); color:#0f172a; font-weight:700; }
    
    /* header & small helpers */
    .brandHeader { background: linear-gradient(90deg,#0b2a4a 0%, #0f172a 100%); color:white; }
    .logo-small { width:36px; height:auto; }
    .compact-table td, .compact-table th { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; padding:.6rem; }

    /* KB paper + editor */
    .paper { background:#fff; width:8.27in; height:11.69in; margin:1.25rem auto; padding:0; box-shadow:0 6px 22px rgba(2,6,23,.06); border-radius:6px; font-size:11pt; line-height:1.3; color:#000; position:relative; overflow:hidden; }
    .paper.first-page { padding:.6in .75in .75in .75in; }
    .paper.content-page { padding:.4in .75in .75in .75in; }
    .paper-content { min-height:8.5in; max-height:9.2in; overflow:hidden; padding-bottom:.6in; }
    .title-header { text-align:center; border-bottom:1px solid #e5e7eb; padding-bottom:6px; margin-bottom:.12in; }
    .title-header img { display:block; margin:0 auto 6px; width:110px; }
    .title-header h1 { font-size:14pt; font-weight:700; margin:2px 0; color:#0f172a; }
    .title-details { font-size:9pt; color:#555; line-height:1.2; display:flex; justify-content:center; gap:10px; flex-wrap:wrap; }
    .page-footer { position:absolute; bottom:.38in; left:.75in; right:.75in; padding-top:6px; border-top:1px solid #e6e6e6; font-size:8pt; color:#666; display:flex; justify-content:space-between; }

    /* editor */
    .editor { min-height:220px; border:1px solid #e5e7eb; padding:.75rem; border-radius:.5rem; background:#fff; }
    .editor:focus { box-shadow:0 0 0 4px rgba(59,130,246,.08); outline:none; }

    /* accordion */
    .kb-accordion .acc-item + .acc-item { border-top:1px solid #eef2f7; }
    .kb-accordion .acc-btn { width:100%; text-align:left; padding:1rem 0.75rem; display:flex; justify-content:space-between; align-items:center; color:#0f172a; }
    .kb-accordion .acc-panel { padding:.75rem 0.75rem 1rem; color:#334155; background:#fbfdff; border-radius:4px; margin:0.5rem .5rem 1rem .5rem; }

    /* loader */
    #globalLoader { display:none; position:fixed; inset:0; background:rgba(0,0,0,.26); z-index:90; align-items:center; justify-content:center; backdrop-filter: blur(2px); }
    .spinner { width:36px; height:36px; border:4px solid #eee; border-top:4px solid #3b82f6; border-radius:50%; animation:spin 1s linear infinite; }
    @keyframes spin { 0%{transform:rotate(0)}100%{transform:rotate(360deg)} }

    /* small screens */
    @media (max-width:768px) {
      .drawer { width:78%; }
      .paper { margin:0.8rem; }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="brandHeader sticky top-0 z-40">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <img src="https://americanrangewalls.com/wp-content/uploads/logo-white-text-on-clear-1.png" alt="ARW Logo" class="logo-small">
        <div>
          <div class="text-sm font-semibold">American Range Walls</div>
          <div class="text-xs opacity-80">Knowledge & Operations Portal</div>
        </div>
      </div>
      <div class="flex items-center gap-4">
        <div class="hidden sm:flex items-center gap-3 text-sm opacity-90">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M12 8v4l3 3"/></svg>
          <div class="text-white text-sm">ARW Blue • Portal</div>
        </div>
        <button id="menuBtn" class="bg-white/10 hover:bg-white/20 p-2 rounded-full text-white">
          <span class="material-symbols-rounded">menu</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Drawer -->
  <aside id="drawer" class="drawer fixed top-0 left-0 h-full w-64 bg-white shadow-2xl z-50">
    <div class="flex items-center justify-between p-4 pt-5 border-b sticky top-0 bg-white z-10">
      <div class="flex items-center gap-3">
        <img src="https://americanrangewalls.com/wp-content/uploads/logo-white-text-on-clear-1.png" alt="ARW Logo" class="h-10 object-contain">
        <div class="text-sm font-semibold">ARW Portal</div>
      </div>
      <button id="closeDrawerBtn" class="text-gray-600 p-2 rounded-full hover:bg-gray-100 transition">
        <span class="material-symbols-rounded">close</span>
      </button>
    </div>

    <nav class="p-4">
      <!-- Prominent home hub placed at top -->
      <div class="mb-4">
        <button class="nav-item nav-active" data-page="homehub">
          <span class="material-symbols-rounded text-brandAccent">home</span>
          <span class="flex-1 text-sm">Home Hub</span>
          <span class="text-xs px-2 py-0.5 bg-brandAccent/10 rounded-full text-brandAccent">Central</span>
        </button>
      </div>

      <ul class="space-y-2">
        <li>
          <button class="nav-item" data-page="knowledge">
            <span class="material-symbols-rounded text-brandAccent">menu_book</span>
            <span>Knowledge Base</span>
          </button>
        </li>
        <!-- Add any future links below -->
      </ul>

      <div class="mt-6 text-xs text-gray-500 px-1">
        <div class="mb-1">Quick Links</div>
        <a class="block text-sm p-2 rounded hover:bg-slate-50" href="#" onclick="alert('Coming soon — search & shortcuts')">Search docs & shortcuts</a>
        <a class="block text-sm p-2 rounded hover:bg-slate-50" href="#" onclick="alert('Coming soon — help center')">Help center</a>
      </div>
    </nav>

    <div class="mt-auto p-4 border-t text-xs text-gray-500">
      ARW • Portal v1.0<br>
      © 2025 American Range Walls
    </div>
  </aside>

  <!-- Overlay -->
  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-30 hidden z-40"></div>

  <!-- Main content wrapper -->
  <div class="flex-1 min-h-screen">

    <main class="max-w-7xl mx-auto p-6 lg:p-10">
      <!-- Home Hub page -->
      <section id="page-homehub" class="page-section">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-start">
          <!-- left: welcome / quick actions -->
          <div class="md:col-span-1 bg-white rounded-xl p-6 shadow-sm">
            <h2 class="text-xl font-bold text-brandDark mb-2">Home Hub</h2>
            <p class="text-sm text-gray-600 mb-4">Central access to SOPs, tutorials and quick tools.</p>

            <div class="space-y-3">
              <button class="w-full px-4 py-2 bg-brandAccent text-white rounded-md font-semibold hover:opacity-95" onclick="loadPage('knowledge')">Open Knowledge Base</button>
              <button class="w-full px-4 py-2 border border-slate-200 rounded-md hover:bg-slate-50" onclick="alert('Feature: Recently used documents')">Recent documents</button>
              <button class="w-full px-4 py-2 border border-slate-200 rounded-md hover:bg-slate-50" onclick="alert('Feature: Upload SOP')">Upload SOP</button>
            </div>

            <div class="mt-6 text-sm text-gray-500">
              <div><strong>Portal tips</strong></div>
              <ul class="mt-2 list-disc pl-5 space-y-1">
                <li>Use Knowledge Base for official SOPs.</li>
                <li>Use the editor to draft & print compliant pages.</li>
              </ul>
            </div>
          </div>

          <!-- center: accordion (big) -->
          <div class="md:col-span-2 bg-white rounded-xl p-6 shadow-sm">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-lg font-semibold text-brandDark">Departments</h3>
              <div class="text-sm text-gray-500">Expand a section to view SOP collections</div>
            </div>

            <div class="kb-accordion space-y-2">
              <div class="acc-item bg-white rounded-md p-1">
                <button class="acc-btn flex items-center justify-between w-full" data-acc="1">
                  <div class="flex items-center gap-3"><span class="material-symbols-rounded text-brandAccent">account_balance</span><span>Accounting</span></div>
                  <span class="material-symbols-rounded">expand_more</span>
                </button>
                <div class="acc-panel hidden">
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: AP Procedures (sample)')">AP Procedures</a>
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: AR Procedures (sample)')">AR Procedures</a>
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: Month-end checklist')">Month-end checklist</a>
                  </div>
                </div>
              </div>

              <div class="acc-item bg-white rounded-md p-1">
                <button class="acc-btn flex items-center justify-between w-full" data-acc="2">
                  <div class="flex items-center gap-3"><span class="material-symbols-rounded text-brandAccent">warehouse</span><span>Mfg & Supply Chain</span></div>
                  <span class="material-symbols-rounded">expand_more</span>
                </button>
                <div class="acc-panel hidden">
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: Receiving SOP')">Receiving SOP</a>
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: Inventory cycle counts')">Inventory cycle counts</a>
                  </div>
                </div>
              </div>

              <div class="acc-item bg-white rounded-md p-1">
                <button class="acc-btn flex items-center justify-between w-full" data-acc="3">
                  <div class="flex items-center gap-3"><span class="material-symbols-rounded text-brandAccent">storefront</span><span>Sales & Marketing</span></div>
                  <span class="material-symbols-rounded">expand_more</span>
                </button>
                <div class="acc-panel hidden">
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: Pricing approval')">Pricing approval</a>
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: Customer pricing matrix')">Customer pricing matrix</a>
                  </div>
                </div>
              </div>

              <div class="acc-item bg-white rounded-md p-1">
                <button class="acc-btn flex items-center justify-between w-full" data-acc="4">
                  <div class="flex items-center gap-3"><span class="material-symbols-rounded text-brandAccent">support_agent</span><span>Customer Service</span></div>
                  <span class="material-symbols-rounded">expand_more</span>
                </button>
                <div class="acc-panel hidden">
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: Returns SOP')">Returns SOP</a>
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: Communication templates')">Communication templates</a>
                  </div>
                </div>
              </div>

              <div class="acc-item bg-white rounded-md p-1">
                <button class="acc-btn flex items-center justify-between w-full" data-acc="5">
                  <div class="flex items-center gap-3"><span class="material-symbols-rounded text-brandAccent">settings</span><span>IT & Technology</span></div>
                  <span class="material-symbols-rounded">expand_more</span>
                </button>
                <div class="acc-panel hidden">
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: Access control')">Access control</a>
                    <a class="block p-3 border rounded hover:bg-slate-50" href="#" onclick="alert('Open: System maintenance')">System maintenance</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Knowledge Base page (embedded KB & Tutorials) -->
      <section id="page-knowledge" class="page-section hidden mt-6">
        <div class="bg-white rounded-xl p-6 shadow-sm mb-6 flex items-center gap-4">
          <img src="https://americanrangewalls.com/wp-content/uploads/logo-white-text-on-clear-1.png" alt="ARW" class="w-28">
          <div>
            <h2 class="text-2xl font-bold text-brandDark">Knowledge Base & Tutorials</h2>
            <p class="text-sm text-gray-600">Official SOPs, printable documents, and tutorial videos.</p>
          </div>
        </div>

        <!-- internal tabs -->
        <div class="bg-white rounded-md px-4 py-3 mb-6 shadow-sm">
          <div class="flex gap-4">
            <button class="tab-btn px-4 py-2 border-b-2 border-transparent hover:text-brandAccent" data-tab="home">Home</button>
            <button class="tab-btn px-4 py-2 border-b-2 border-transparent hover:text-brandAccent" data-tab="kb">Knowledge Base</button>
            <button class="tab-btn px-4 py-2 border-b-2 border-transparent hover:text-brandAccent" data-tab="tutorials">Tutorial Videos</button>
          </div>
        </div>

        <div id="kbApp">
          <!-- HOME tab -->
          <div id="tab-home" class="tab-content">
            <div class="bg-white rounded-xl p-6 shadow-sm">
              <h3 class="text-lg font-semibold text-brandDark">Welcome</h3>
              <p class="text-sm text-gray-600">Browse documents below or use the KB link to manage documents and tutorial videos.</p>
            </div>
          </div>

          <!-- KB list (hidden until user uses it) -->
          <div id="tab-kb" class="tab-content hidden">
            <div id="kbListView">
              <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 gap-4">
                <div class="flex gap-3">
                  <button id="addDocBtn" class="px-4 py-2 bg-brandAccent text-white rounded-md font-semibold hover:opacity-90">+ New Document</button>
                  <input id="kbSearchInput" placeholder="Search..." class="px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brandAccent" />
                </div>
              </div>

              <div class="bg-white border rounded-lg shadow-sm overflow-x-auto">
                <table class="min-w-full compact-table w-full">
                  <thead class="bg-gray-100 border-b">
                    <tr>
                      <th class="px-4 text-left text-xs font-semibold uppercase">Doc ID</th>
                      <th class="px-4 text-left text-xs font-semibold uppercase">Title</th>
                      <th class="px-4 text-left text-xs font-semibold uppercase">Category</th>
                      <th class="px-4 text-left text-xs font-semibold uppercase">Process</th>
                      <th class="px-4 text-left text-xs font-semibold uppercase">Status</th>
                      <th class="px-4 text-right text-xs font-semibold uppercase no-print">Actions</th>
                    </tr>
                  </thead>
                  <tbody id="kbDocsTable" class="text-sm">
                    <!-- populated by JS -->
                  </tbody>
                </table>
              </div>
            </div>

            <div id="kbPreviewView" class="hidden mt-6">
              <div class="mb-6 flex justify-between items-center no-print">
                <button id="kbBackBtn" class="px-6 py-3 rounded-xl bg-slate-200 hover:bg-slate-300 text-brandDark font-semibold transition-all duration-300 flex items-center gap-2">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                  Back to List
                </button>
                <h2 id="kbPreviewTitle" class="text-2xl font-bold text-brandDark">Document Preview</h2>
                <button id="kbPrintBtn" class="px-4 py-2 bg-brandAccent text-white rounded-md">Print/Download</button>
              </div>

              <div id="kbPreviewContainer" class="bg-slate-100 p-8 rounded-2xl">
                <!-- pages inserted by JS -->
              </div>
            </div>
          </div>

          <!-- Tutorials -->
          <div id="tab-tutorials" class="tab-content hidden">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-lg font-semibold text-brandDark">Tutorial Videos</h3>
              <button id="addTutBtn" class="px-3 py-2 bg-brandAccent text-white rounded-md">+ New</button>
            </div>

            <div class="bg-white border rounded-lg shadow-sm overflow-x-auto">
              <table class="min-w-full compact-table w-full">
                <thead class="bg-gray-100 border-b">
                  <tr>
                    <th class="px-4 text-left text-xs font-semibold uppercase">Tutorial ID</th>
                    <th class="px-4 text-left text-xs font-semibold uppercase">Title</th>
                    <th class="px-4 text-left text-xs font-semibold uppercase">Description</th>
                    <th class="px-4 text-left text-xs font-semibold uppercase">Link</th>
                    <th class="px-4 text-right text-xs font-semibold uppercase">Actions</th>
                  </tr>
                </thead>
                <tbody id="tutorialTable" class="text-sm">
                  <!-- populated by JS -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- KB Modal -->
        <div id="kbModal" class="hidden fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4">
          <div class="bg-white rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto border border-slate-200 shadow-2xl">
            <div class="sticky top-0 bg-slate-50 border-b p-4 flex justify-between items-center">
              <h3 id="kbModalTitle" class="text-lg font-bold text-brandDark">New Document</h3>
              <button id="kbCloseModal" class="p-2 text-gray-500 hover:bg-slate-100 rounded"><span class="material-symbols-rounded">close</span></button>
            </div>
            <form id="kbForm" class="p-4 space-y-3">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <input name="Title" placeholder="Title" class="w-full px-3 py-2 border rounded" required>
                <select name="Category" class="w-full px-3 py-2 border rounded"></select>
                <select name="Process" class="w-full px-3 py-2 border rounded"></select>
                <select name="Owner" class="w-full px-3 py-2 border rounded"></select>
                <select name="Approved_By" class="w-full px-3 py-2 border rounded"></select>
                <select name="Status" class="w-full px-3 py-2 border rounded"></select>
              </div>
              <div>
                <label class="block text-sm font-semibold mb-1">Document Content</label>
                <div id="kbPolicyEditor" class="editor" contenteditable="true">Enter content...</div>
                <input type="hidden" name="Policy_Body">
              </div>
              <div class="flex justify-end gap-3">
                <button type="button" id="kbCancelBtn" class="px-4 py-2 border rounded">Cancel</button>
                <button type="submit" class="px-4 py-2 bg-brandAccent text-white rounded">Save</button>
              </div>
            </form>
          </div>
        </div>

        <!-- Tutorial modal -->
        <div id="tutorialModal" class="hidden fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4">
          <div class="bg-white rounded-lg max-w-xl w-full p-4 shadow-lg">
            <div class="flex justify-between items-center mb-3">
              <h4 class="font-semibold">New Tutorial</h4>
              <button id="tutorialCloseModal" class="p-2 text-gray-500 rounded hover:bg-slate-100"><span class="material-symbols-rounded">close</span></button>
            </div>
            <form id="tutorialForm" class="space-y-2">
              <input name="Title" placeholder="Title" class="w-full px-3 py-2 border rounded" required>
              <input name="Drive_Link" placeholder="YouTube/Drive link" class="w-full px-3 py-2 border rounded" required>
              <textarea name="Description" placeholder="Description" class="w-full px-3 py-2 border rounded" rows="3"></textarea>
              <div class="flex justify-end gap-2"><button type="button" id="tutorialCancelBtn" class="px-3 py-2 border rounded">Cancel</button><button type="submit" class="px-3 py-2 bg-brandAccent text-white rounded">Save</button></div>
            </form>
          </div>
        </div>
      </section>
    </main>

    <!-- Sticky footer -->
    <footer class="bg-brandDark text-white py-4">
      <div class="max-w-7xl mx-auto px-6 text-sm flex items-center justify-between">
        <div>© 2025 American Range Walls</div>
        <div class="text-xs opacity-80">Knowledge Portal — Built for ARW</div>
      </div>
    </footer>
  </div>

  <!-- Loader & overlay -->
  <div id="globalLoader"><div class="bg-white p-4 rounded-md shadow flex items-center gap-3"><div class="spinner"></div><div>Loading…</div></div></div>

  <!-- Inline JS -->
  <script>
    // Drawer controls
    const drawer = document.getElementById('drawer');
    const overlay = document.getElementById('overlay');
    const menuBtn = document.getElementById('menuBtn');
    const closeDrawerBtn = document.getElementById('closeDrawerBtn');

    function toggleDrawer(open){
      if(open){ drawer.classList.add('drawer-open'); overlay.classList.remove('hidden'); }
      else { drawer.classList.remove('drawer-open'); overlay.classList.add('hidden'); }
    }
    menuBtn.addEventListener('click', ()=> toggleDrawer(true));
    closeDrawerBtn.addEventListener('click', ()=> toggleDrawer(false));
    overlay.addEventListener('click', ()=> toggleDrawer(false));

    // Page navigation (only homehub and knowledge)
    function hideAllPages(){
      document.querySelectorAll('.page-section').forEach(s => s.classList.add('hidden'));
    }
    function loadPage(page){
      hideAllPages();
      if(page === 'homehub'){ document.getElementById('page-homehub').classList.remove('hidden'); document.getElementById('pageTitle')?.remove(); }
      if(page === 'knowledge'){ document.getElementById('page-knowledge').classList.remove('hidden'); }
      // active state
      document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('nav-active'));
      document.querySelectorAll('.nav-item').forEach(n=>{ if(n.dataset.page === page) n.classList.add('nav-active'); });
      toggleDrawer(false);
      window.scrollTo({ top: 0, behavior: 'smooth' });
      // default KB tab when opening knowledge
      if(page === 'knowledge'){ setTimeout(()=> { const homeBtn = document.querySelector('.tab-btn[data-tab="home"]'); if(homeBtn) homeBtn.click(); }, 120); }
    }

    // attach nav
    document.querySelectorAll('.nav-item').forEach(btn => btn.addEventListener('click', ()=> loadPage(btn.dataset.page)));

    // Default landing: Home Hub
    loadPage('homehub');

    // Accordion behavior
    document.querySelectorAll('.kb-accordion .acc-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const panel = btn.nextElementSibling;
        const isOpen = !panel.classList.contains('hidden');
        // close all
        document.querySelectorAll('.kb-accordion .acc-panel').forEach(p => p.classList.add('hidden'));
        document.querySelectorAll('.kb-accordion .acc-btn .material-symbols-rounded').forEach(i => i.textContent = 'expand_more');
        if(!isOpen){
          panel.classList.remove('hidden');
          btn.querySelector('.material-symbols-rounded').textContent = 'expand_less';
        } else {
          panel.classList.add('hidden');
          btn.querySelector('.material-symbols-rounded').textContent = 'expand_more';
        }
      });
    });

    // KB tabs wiring (simple)
    document.querySelectorAll('.tab-btn').forEach(btn => btn.addEventListener('click', (e) => {
      const target = btn.dataset.tab;
      document.querySelectorAll('.tab-content').forEach(tc => tc.classList.add('hidden'));
      const el = document.getElementById('tab-' + target);
      if(el) el.classList.remove('hidden');
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('text-brandAccent','border-brandAccent'));
      btn.classList.add('text-brandAccent','border-brandAccent');
      // lazy-load: you can hook loadKbDocs() & loadTutorials() here if API_URL is configured
      if(target === 'kb'){ /* loadKbConfig(); loadKbDocs(); */ }
      if(target === 'tutorials'){ /* loadTutorials(); */ }
    }));

    // default KB internal tab
    (function(){ const first = document.querySelector('.tab-btn[data-tab="home"]'); if(first) first.click(); })();

    // Modal placeholders (open/close behavior)
    document.getElementById('kbCloseModal')?.addEventListener('click', ()=> document.getElementById('kbModal').classList.add('hidden'));
    document.getElementById('kbCancelBtn')?.addEventListener('click', ()=> document.getElementById('kbModal').classList.add('hidden'));
    document.getElementById('addDocBtn')?.addEventListener('click', ()=> { document.getElementById('kbModal').classList.remove('hidden'); });

    document.getElementById('tutorialCloseModal')?.addEventListener('click', ()=> document.getElementById('tutorialModal').classList.add('hidden'));
    document.getElementById('tutorialCancelBtn')?.addEventListener('click', ()=> document.getElementById('tutorialModal').classList.add('hidden'));
    document.getElementById('addTutBtn')?.addEventListener('click', ()=> { document.getElementById('tutorialModal').classList.remove('hidden'); });

    // Loader helper
    window.showLoader = function(s){ document.getElementById('globalLoader').style.display = s ? 'flex' : 'none'; };

    // NOTE: The KB CRUD & tutorial code (fetching/saving) is intentionally not included here to keep this file safe for preview.
    // If you'd like, I can plug in your Apps Script API_URL and re-enable the existing CRUD functions from your earlier files.
  </script>
</body>
</html>
