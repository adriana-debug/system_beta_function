<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Knowledge Base</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/feather-icons"></script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen transition-colors duration-300">

  <!-- Header -->
  <header class="bg-white dark:bg-gray-800 shadow px-6 py-4 flex justify-between items-center">
    <h1 class="text-xl font-bold text-gray-800 dark:text-gray-100">Knowledge Base</h1>
    <button id="themeToggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700">
      <i data-feather="moon"></i>
    </button>
  </header>

  <!-- Main -->
  <main class="p-6">
    <div class="flex justify-between mb-4">
      <input type="text" id="searchInput" placeholder="Search..."
        class="w-1/3 px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-300"/>
      <button onclick="openModal()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md">
        Add Document
      </button>
    </div>

    <!-- Table -->
    <div class="overflow-x-auto bg-white dark:bg-gray-800 shadow rounded-lg">
      <table class="w-full border-collapse">
        <thead>
          <tr class="bg-gray-100 dark:bg-gray-700">
            <th class="px-4 py-2 text-left font-semibold text-gray-700 dark:text-gray-200">ID</th>
            <th class="px-4 py-2 text-left font-semibold text-gray-700 dark:text-gray-200">Name</th>
            <th class="px-4 py-2 text-left font-semibold text-gray-700 dark:text-gray-200">Category</th>
            <th class="px-4 py-2 text-left font-semibold text-gray-700 dark:text-gray-200">Author</th>
            <th class="px-4 py-2 text-left font-semibold text-gray-700 dark:text-gray-200">Actions</th>
          </tr>
        </thead>
        <tbody id="docList" class="divide-y divide-gray-200 dark:divide-gray-700">
          <!-- Rows rendered here -->
        </tbody>
      </table>
    </div>
  </main>

  <!-- CRUD Modal -->
  <div id="crudModal" class="fixed inset-0 hidden items-center justify-center bg-black/50 z-50">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg w-1/2">
      <h2 id="modalTitle" class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Add Document</h2>
      <form id="docForm" class="space-y-4">
        <div>
          <label class="block text-gray-700 dark:text-gray-200">Document Name</label>
          <input type="text" id="documentName" required
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-900 text-gray-700 dark:text-gray-100"/>
        </div>
        <div>
          <label class="block text-gray-700 dark:text-gray-200">Category</label>
          <input type="text" id="category" required
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-900 text-gray-700 dark:text-gray-100"/>
        </div>
        <div>
          <label class="block text-gray-700 dark:text-gray-200">Content</label>
          <textarea id="documentContent" required
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-900 text-gray-700 dark:text-gray-100"></textarea>
        </div>
        <div class="flex justify-end gap-3">
          <button type="button" onclick="closeModal()" class="px-4 py-2 rounded-md bg-gray-300 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-400 dark:hover:bg-gray-600">Cancel</button>
          <button type="submit" class="px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white">Save</button>
        </div>
      </form>
    </div>
  </div>

  <!-- View Modal -->
  <div id="viewModal" class="fixed inset-0 hidden items-center justify-center bg-black/50 z-50">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg w-2/3 max-h-[80vh] overflow-y-auto">
      <h2 id="vTitle" class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-2">Document Title</h2>
      <p id="vMeta" class="text-sm text-gray-600 dark:text-gray-300 mb-4">Author · Date</p>
      <div id="vContent" class="prose dark:prose-invert text-gray-700 dark:text-gray-200">
        <p class="italic text-gray-500 dark:text-gray-300">Loading content...</p>
      </div>
      <div class="flex justify-end mt-4">
        <button onclick="closeView()" class="px-4 py-2 rounded-md bg-gray-300 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-400 dark:hover:bg-gray-600">Close</button>
      </div>
    </div>
  </div>

  <script>
    feather.replace();

    const toggleBtn = document.getElementById('themeToggle');
    toggleBtn.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      toggleBtn.innerHTML = document.body.classList.contains('dark')
        ? feather.icons.sun.toSvg()
        : feather.icons.moon.toSvg();
    });

    // Example Data
    let docs = [
      {id:"KB-2025-001", name:"Issuing an NTE - SOP", category:"HR Policies", author:"Admin", content:"Detailed steps on issuing an NTE..."},
      {id:"KB-2025-002", name:"Login Troubleshooting", category:"IT Support", author:"TechOps", content:"Steps to resolve login issues..."}
    ];

    function renderList(){
      const tbody = document.getElementById("docList");
      tbody.innerHTML = "";
      docs.forEach(doc => {
        tbody.innerHTML += `
          <tr class="text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
            <td class="px-4 py-2">${doc.id}</td>
            <td class="px-4 py-2">${doc.name}</td>
            <td class="px-4 py-2">${doc.category}</td>
            <td class="px-4 py-2">${doc.author}</td>
            <td class="px-4 py-2 flex gap-2">
              <button onclick="viewDoc('${doc.id}')" class="text-blue-600 hover:underline">View</button>
              <button onclick="editDoc('${doc.id}')" class="text-green-600 hover:underline">Edit</button>
              <button onclick="deleteDoc('${doc.id}')" class="text-red-600 hover:underline">Delete</button>
            </td>
          </tr>
        `;
      });
    }

    renderList();

    // Modal functions
    function openModal(){
      document.getElementById("crudModal").classList.remove("hidden");
    }
    function closeModal(){
      document.getElementById("crudModal").classList.add("hidden");
    }
    function openView(){
      document.getElementById("viewModal").classList.remove("hidden");
    }
    function closeView(){
      document.getElementById("viewModal").classList.add("hidden");
    }

    function viewDoc(id){
      const doc = docs.find(d => d.id===id);
      document.getElementById("vTitle").innerText = doc.name;
      document.getElementById("vMeta").innerText = `${doc.author} · ${new Date().toLocaleDateString()}`;
      document.getElementById("vContent").innerHTML = `<p>${doc.content}</p>`;
      openView();
    }
    function editDoc(id){ alert("Edit " + id); }
    function deleteDoc(id){
      docs = docs.filter(d => d.id!==id);
      renderList();
    }
  </script>
</body>
</html>
