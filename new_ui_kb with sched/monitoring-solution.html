<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Business Metrics Monitor</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Google Sans', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      background: white;
      padding: 24px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .header h1 {
      color: #667eea;
      font-size: 28px;
      margin-bottom: 8px;
    }

    .header p {
      color: #666;
      font-size: 14px;
    }

    .status-bar {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .status-card {
      flex: 1;
      min-width: 200px;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .status-icon {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .status-icon.green {
      background: #10b981;
      color: white;
    }

    .status-icon.yellow {
      background: #f59e0b;
      color: white;
    }

    .status-icon.red {
      background: #ef4444;
      color: white;
    }

    .status-info h3 {
      font-size: 14px;
      color: #666;
      margin-bottom: 4px;
    }

    .status-info p {
      font-size: 24px;
      font-weight: bold;
      color: #333;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .card {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .card h2 {
      color: #333;
      font-size: 18px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .metric-item {
      padding: 12px;
      background: #f9fafb;
      border-radius: 8px;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .metric-item:last-child {
      margin-bottom: 0;
    }

    .metric-label {
      font-size: 14px;
      color: #666;
    }

    .metric-value {
      font-size: 16px;
      font-weight: bold;
      color: #333;
    }

    .metric-trend {
      font-size: 12px;
      margin-left: 8px;
    }

    .trend-up {
      color: #10b981;
    }

    .trend-down {
      color: #ef4444;
    }

    .alert {
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
    }

    .alert.warning {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      color: #92400e;
    }

    .alert.critical {
      background: #fee2e2;
      border-left: 4px solid #ef4444;
      color: #991b1b;
    }

    .alert.info {
      background: #dbeafe;
      border-left: 4px solid #3b82f6;
      color: #1e40af;
    }

    .alert-time {
      font-size: 11px;
      opacity: 0.7;
      margin-left: auto;
    }

    .log-entry {
      padding: 10px;
      border-bottom: 1px solid #e5e7eb;
      font-size: 13px;
      font-family: 'Courier New', monospace;
    }

    .log-entry:last-child {
      border-bottom: none;
    }

    .log-time {
      color: #6b7280;
      margin-right: 8px;
    }

    .log-level {
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 11px;
      margin-right: 8px;
      font-weight: bold;
    }

    .log-level.info {
      background: #dbeafe;
      color: #1e40af;
    }

    .log-level.warn {
      background: #fef3c7;
      color: #92400e;
    }

    .log-level.error {
      background: #fee2e2;
      color: #991b1b;
    }

    .chart-container {
      height: 200px;
      margin-top: 16px;
    }

    .chart-bar {
      display: flex;
      align-items: flex-end;
      gap: 8px;
      height: 150px;
      margin-top: 16px;
    }

    .bar {
      flex: 1;
      background: linear-gradient(to top, #667eea, #764ba2);
      border-radius: 4px 4px 0 0;
      min-height: 10px;
      position: relative;
      transition: all 0.3s ease;
    }

    .bar:hover {
      opacity: 0.8;
    }

    .bar-label {
      position: absolute;
      bottom: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 11px;
      color: #666;
      white-space: nowrap;
    }

    .bar-value {
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 11px;
      font-weight: bold;
      color: #333;
    }

    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: background 0.2s;
    }

    button:hover {
      background: #5568d3;
    }

    button:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }

    .refresh-btn {
      margin-top: 16px;
      width: 100%;
    }

    .last-updated {
      text-align: center;
      color: white;
      font-size: 13px;
      margin-top: 20px;
      opacity: 0.9;
    }

    .loading {
      display: none;
      text-align: center;
      padding: 20px;
      color: #667eea;
    }

    .spinner {
      border: 3px solid #f3f4f6;
      border-top: 3px solid #667eea;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
      
      .status-bar {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìä Business Metrics Monitor</h1>
      <p>Real-time monitoring dashboard for Google Workspace metrics and knowledge base</p>
    </div>

    <div class="status-bar">
      <div class="status-card">
        <div class="status-icon green" id="systemStatus">‚úì</div>
        <div class="status-info">
          <h3>System Status</h3>
          <p id="statusText">Operational</p>
        </div>
      </div>
      <div class="status-card">
        <div class="status-icon green" id="uptimeIcon">‚è±</div>
        <div class="status-info">
          <h3>Uptime</h3>
          <p id="uptimeText">99.8%</p>
        </div>
      </div>
      <div class="status-card">
        <div class="status-icon yellow" id="alertIcon">‚ö†</div>
        <div class="status-info">
          <h3>Active Alerts</h3>
          <p id="alertCount">2</p>
        </div>
      </div>
    </div>

    <div class="grid">
      <!-- Business Metrics -->
      <div class="card">
        <h2>üìà Business Metrics</h2>
        <div class="metric-item">
          <span class="metric-label">Total Documents</span>
          <span>
            <span class="metric-value" id="docCount">1,247</span>
            <span class="metric-trend trend-up">‚Üë 12%</span>
          </span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Active Users (24h)</span>
          <span>
            <span class="metric-value" id="activeUsers">342</span>
            <span class="metric-trend trend-up">‚Üë 8%</span>
          </span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Collaborations</span>
          <span>
            <span class="metric-value" id="collabCount">89</span>
            <span class="metric-trend trend-down">‚Üì 3%</span>
          </span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Storage Used</span>
          <span>
            <span class="metric-value" id="storageUsed">78.5 GB</span>
            <span class="metric-trend trend-up">‚Üë 5%</span>
          </span>
        </div>
      </div>

      <!-- Knowledge Base Stats -->
      <div class="card">
        <h2>üìö Knowledge Base</h2>
        <div class="metric-item">
          <span class="metric-label">Total Articles</span>
          <span class="metric-value" id="kbArticles">456</span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Views (Today)</span>
          <span>
            <span class="metric-value" id="kbViews">2,341</span>
            <span class="metric-trend trend-up">‚Üë 15%</span>
          </span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Search Queries</span>
          <span>
            <span class="metric-value" id="searchQueries">567</span>
            <span class="metric-trend trend-up">‚Üë 22%</span>
          </span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Avg. Response Time</span>
          <span class="metric-value" id="responseTime">1.2s</span>
        </div>
        <div class="chart-bar">
          <div class="bar" style="height: 60%;">
            <span class="bar-value">245</span>
            <span class="bar-label">Mon</span>
          </div>
          <div class="bar" style="height: 75%;">
            <span class="bar-value">312</span>
            <span class="bar-label">Tue</span>
          </div>
          <div class="bar" style="height: 85%;">
            <span class="bar-value">356</span>
            <span class="bar-label">Wed</span>
          </div>
          <div class="bar" style="height: 70%;">
            <span class="bar-value">289</span>
            <span class="bar-label">Thu</span>
          </div>
          <div class="bar" style="height: 90%;">
            <span class="bar-value">378</span>
            <span class="bar-label">Fri</span>
          </div>
          <div class="bar" style="height: 45%;">
            <span class="bar-value">189</span>
            <span class="bar-label">Sat</span>
          </div>
          <div class="bar" style="height: 40%;">
            <span class="bar-value">167</span>
            <span class="bar-label">Sun</span>
          </div>
        </div>
      </div>

      <!-- Active Alerts -->
      <div class="card">
        <h2>üîî Active Alerts</h2>
        <div id="alertsList">
          <div class="alert warning">
            <span>‚ö†Ô∏è</span>
            <span>Storage usage above 75%</span>
            <span class="alert-time">5m ago</span>
          </div>
          <div class="alert info">
            <span>‚ÑπÔ∏è</span>
            <span>New users spike detected</span>
            <span class="alert-time">23m ago</span>
          </div>
        </div>
        <button class="refresh-btn" onclick="refreshAlerts()">Refresh Alerts</button>
      </div>

      <!-- Performance Tracking -->
      <div class="card">
        <h2>‚ö° Performance</h2>
        <div class="metric-item">
          <span class="metric-label">API Response Time</span>
          <span class="metric-value" id="apiResponse">245ms</span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Script Executions (1h)</span>
          <span class="metric-value" id="scriptExec">1,234</span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Failed Requests</span>
          <span>
            <span class="metric-value" id="failedReq">12</span>
            <span class="metric-trend trend-down">‚Üì 40%</span>
          </span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Success Rate</span>
          <span class="metric-value" id="successRate">99.1%</span>
        </div>
      </div>

      <!-- Recent Logs -->
      <div class="card">
        <h2>üìù Recent Logs</h2>
        <div id="logsList" style="max-height: 250px; overflow-y: auto;">
          <div class="log-entry">
            <span class="log-time">14:32:45</span>
            <span class="log-level info">INFO</span>
            <span>User authentication successful</span>
          </div>
          <div class="log-entry">
            <span class="log-time">14:31:22</span>
            <span class="log-level info">INFO</span>
            <span>Document created: Q4_Report.docx</span>
          </div>
          <div class="log-entry">
            <span class="log-time">14:29:15</span>
            <span class="log-level warn">WARN</span>
            <span>High storage usage detected</span>
          </div>
          <div class="log-entry">
            <span class="log-time">14:27:03</span>
            <span class="log-level info">INFO</span>
            <span>KB search query: "how to reset password"</span>
          </div>
          <div class="log-entry">
            <span class="log-time">14:25:41</span>
            <span class="log-level error">ERROR</span>
            <span>API rate limit exceeded</span>
          </div>
        </div>
        <button class="refresh-btn" onclick="refreshLogs()">Refresh Logs</button>
      </div>

      <!-- Uptime Monitor -->
      <div class="card">
        <h2>‚è± Uptime Monitor</h2>
        <div class="metric-item">
          <span class="metric-label">Current Uptime</span>
          <span class="metric-value" id="currentUptime">15d 7h 23m</span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Last 30 Days</span>
          <span class="metric-value" id="uptime30d">99.8%</span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Last Incident</span>
          <span class="metric-value" id="lastIncident">12 days ago</span>
        </div>
        <div class="metric-item">
          <span class="metric-label">Avg. Resolution Time</span>
          <span class="metric-value" id="resolutionTime">8 minutes</span>
        </div>
      </div>
    </div>

    <div class="loading" id="loading">
      <div class="spinner"></div>
      <p style="margin-top: 16px;">Refreshing data...</p>
    </div>

    <div class="last-updated">
      Last updated: <span id="lastUpdate">Just now</span>
    </div>
  </div>

  <script>
    // Simulated real-time updates
    function updateMetrics() {
      const now = new Date();
      document.getElementById('lastUpdate').textContent = now.toLocaleTimeString();
      
      // Randomly update some metrics to simulate real-time changes
      if (Math.random() > 0.7) {
        const docCount = document.getElementById('docCount');
        docCount.textContent = parseInt(docCount.textContent.replace(',', '')) + Math.floor(Math.random() * 5);
      }
      
      if (Math.random() > 0.8) {
        const activeUsers = document.getElementById('activeUsers');
        activeUsers.textContent = 300 + Math.floor(Math.random() * 100);
      }
    }

    function refreshAlerts() {
      showLoading();
      setTimeout(() => {
        hideLoading();
        alert('Alerts refreshed! In production, this would fetch latest alerts from your Google Sheets or Apps Script backend.');
      }, 1000);
    }

    function refreshLogs() {
      showLoading();
      setTimeout(() => {
        hideLoading();
        const logsDiv = document.getElementById('logsList');
        const newLog = document.createElement('div');
        newLog.className = 'log-entry';
        newLog.innerHTML = `
          <span class="log-time">${new Date().toLocaleTimeString()}</span>
          <span class="log-level info">INFO</span>
          <span>Manual refresh triggered</span>
        `;
        logsDiv.insertBefore(newLog, logsDiv.firstChild);
      }, 800);
    }

    function showLoading() {
      document.getElementById('loading').style.display = 'block';
    }

    function hideLoading() {
      document.getElementById('loading').style.display = 'none';
    }

    // Auto-refresh every 30 seconds
    setInterval(updateMetrics, 30000);
    
    // Initial load
    updateMetrics();
    
    console.log('Monitoring Dashboard Loaded');
    console.log('Ready to integrate with Google Apps Script backend');
  </script>
</body>
</html>
